name: Stale

on:
  schedule:
    - cron: "0 0 * * *"
  workflow_dispatch:

permissions:
  contents: read
  issues: write
  pull-requests: write

jobs:
  stale:
    if: github.repository_owner == 'Ludy87'
    runs-on: ubuntu-latest
    steps:
      # The 90 day stale policy for PRs
      # Used for:
      # - PRs
      # - No issues (-1)
      - name: Harden Runner
        uses: step-security/harden-runner@df199fb7be9f65074067a9eb93f12bb4c5547cf2 # v2.13.3
        with:
          egress-policy: audit

      - name: 90 days stale PRs policy
        uses: actions/stale@5f858e3efba33a5ca4407a664cc011ad407f2008 # v10.1.0
        with:
          repo-token: ${{ secrets.GITHUB_TOKEN }}
          days-before-stale: 23
          days-before-close: 7
          remove-stale-when-updated: true
          stale-issue-label: "stale"
          stale-pr-label: "stale"
          exempt-pr-labels: "wait"
          exempt-issue-labels: "wait,help wanted,in progress"
          stale-issue-message: >
            This issue has now been marked as stale and will be closed if no
            further activity occurs within 7 days.

            Thank you for your contributions.
          stale-pr-message: >
            There hasn't been any activity on this pull request recently. This
            pull request has been automatically marked as stale because of that
            and will be closed if no further activity occurs within 7 days.

            Thank you for your contributions.
